2025-09-20 18:43:21,432 [trainer.py] => dataset: imagenet-r
2025-09-20 18:43:21,432 [trainer.py] => smart_defaults: False
2025-09-20 18:43:21,432 [trainer.py] => user: authors
2025-09-20 18:43:21,432 [trainer.py] => memory_size: 0
2025-09-20 18:43:21,432 [trainer.py] => memory_per_class: 0
2025-09-20 18:43:21,432 [trainer.py] => fixed_memory: False
2025-09-20 18:43:21,432 [trainer.py] => shuffle: True
2025-09-20 18:43:21,432 [trainer.py] => init_cls: 20
2025-09-20 18:43:21,432 [trainer.py] => increment: 20
2025-09-20 18:43:21,432 [trainer.py] => model_name: sldc
2025-09-20 18:43:21,432 [trainer.py] => vit_type: vit-b-p16
2025-09-20 18:43:21,432 [trainer.py] => weight_decay: 0.0
2025-09-20 18:43:21,432 [trainer.py] => device: [device(type='cuda', index=0)]
2025-09-20 18:43:21,433 [trainer.py] => lora_rank: 4
2025-09-20 18:43:21,433 [trainer.py] => lora_type: sgp_lora
2025-09-20 18:43:21,433 [trainer.py] => weight_temp: 5.0
2025-09-20 18:43:21,433 [trainer.py] => weight_kind: log1p
2025-09-20 18:43:21,433 [trainer.py] => weight_p: 1.0
2025-09-20 18:43:21,433 [trainer.py] => nsp_eps: 0.05
2025-09-20 18:43:21,433 [trainer.py] => nsp_weight: 0.0
2025-09-20 18:43:21,433 [trainer.py] => sce_a: 0.5
2025-09-20 18:43:21,433 [trainer.py] => sce_b: 0.5
2025-09-20 18:43:21,433 [trainer.py] => seed_list: [1993]
2025-09-20 18:43:21,433 [trainer.py] => iterations: 20
2025-09-20 18:43:21,433 [trainer.py] => warmup_steps: 200
2025-09-20 18:43:21,433 [trainer.py] => ca_epochs: 5
2025-09-20 18:43:21,433 [trainer.py] => optimizer: sgd
2025-09-20 18:43:21,433 [trainer.py] => lrate: 0.002
2025-09-20 18:43:21,433 [trainer.py] => head_scale: 1.0
2025-09-20 18:43:21,433 [trainer.py] => batch_size: 24
2025-09-20 18:43:21,433 [trainer.py] => gamma_norm: 0.1
2025-09-20 18:43:21,433 [trainer.py] => gamma_kd: 0.0
2025-09-20 18:43:21,433 [trainer.py] => kd_type: feat
2025-09-20 18:43:21,433 [trainer.py] => compensate: True
2025-09-20 18:43:21,433 [trainer.py] => eval_only: False
2025-09-20 18:43:21,433 [trainer.py] => auxiliary_data_path: /data1/open_datasets/ImageNet-2012/train
2025-09-20 18:43:21,433 [trainer.py] => aux_dataset: imagenet
2025-09-20 18:43:21,433 [trainer.py] => auxiliary_data_size: 1024
2025-09-20 18:43:21,433 [trainer.py] => l2_protection: True
2025-09-20 18:43:21,433 [trainer.py] => l2_protection_lambda: 0.0001
2025-09-20 18:43:21,433 [trainer.py] => seed: 1993
2025-09-20 18:43:21,433 [trainer.py] => run_id: 0
2025-09-20 18:43:21,433 [trainer.py] => log_path: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993
2025-09-20 18:43:21,433 [data_manager.py] => [DataManager] args_for_idata = {'dataset': 'imagenet-r', 'smart_defaults': False, 'user': 'authors', 'memory_size': 0, 'memory_per_class': 0, 'fixed_memory': False, 'shuffle': True, 'init_cls': 20, 'increment': 20, 'model_name': 'sldc', 'vit_type': 'vit-b-p16', 'weight_decay': 0.0, 'device': [device(type='cuda', index=0)], 'lora_rank': 4, 'lora_type': 'sgp_lora', 'weight_temp': 5.0, 'weight_kind': 'log1p', 'weight_p': 1.0, 'nsp_eps': 0.05, 'nsp_weight': 0.0, 'sce_a': 0.5, 'sce_b': 0.5, 'seed_list': [1993], 'iterations': 20, 'warmup_steps': 200, 'ca_epochs': 5, 'optimizer': 'sgd', 'lrate': 0.002, 'head_scale': 1.0, 'batch_size': 24, 'gamma_norm': 0.1, 'gamma_kd': 0.0, 'kd_type': 'feat', 'compensate': True, 'eval_only': False, 'auxiliary_data_path': '/data1/open_datasets/ImageNet-2012/train', 'aux_dataset': 'imagenet', 'auxiliary_data_size': 1024, 'l2_protection': True, 'l2_protection_lambda': 0.0001, 'seed': 1993, 'run_id': 0, 'log_path': 'sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993'}
2025-09-20 18:43:21,508 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2025-09-20 18:43:22,798 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-09-20 18:43:23,416 [_hub.py] => [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-09-20 18:43:51,267 [trainer.py] => dataset: imagenet-r
2025-09-20 18:43:51,267 [trainer.py] => smart_defaults: False
2025-09-20 18:43:51,267 [trainer.py] => user: authors
2025-09-20 18:43:51,267 [trainer.py] => memory_size: 0
2025-09-20 18:43:51,267 [trainer.py] => memory_per_class: 0
2025-09-20 18:43:51,267 [trainer.py] => fixed_memory: False
2025-09-20 18:43:51,268 [trainer.py] => shuffle: True
2025-09-20 18:43:51,268 [trainer.py] => init_cls: 20
2025-09-20 18:43:51,268 [trainer.py] => increment: 20
2025-09-20 18:43:51,268 [trainer.py] => model_name: sldc
2025-09-20 18:43:51,268 [trainer.py] => vit_type: vit-b-p16
2025-09-20 18:43:51,268 [trainer.py] => weight_decay: 0.0
2025-09-20 18:43:51,268 [trainer.py] => device: [device(type='cuda', index=0)]
2025-09-20 18:43:51,268 [trainer.py] => lora_rank: 4
2025-09-20 18:43:51,268 [trainer.py] => lora_type: sgp_lora
2025-09-20 18:43:51,268 [trainer.py] => weight_temp: 5.0
2025-09-20 18:43:51,268 [trainer.py] => weight_kind: log1p
2025-09-20 18:43:51,268 [trainer.py] => weight_p: 1.0
2025-09-20 18:43:51,268 [trainer.py] => nsp_eps: 0.05
2025-09-20 18:43:51,268 [trainer.py] => nsp_weight: 0.0
2025-09-20 18:43:51,268 [trainer.py] => sce_a: 0.5
2025-09-20 18:43:51,268 [trainer.py] => sce_b: 0.5
2025-09-20 18:43:51,268 [trainer.py] => seed_list: [1993]
2025-09-20 18:43:51,268 [trainer.py] => iterations: 20
2025-09-20 18:43:51,268 [trainer.py] => warmup_steps: 200
2025-09-20 18:43:51,268 [trainer.py] => ca_epochs: 5
2025-09-20 18:43:51,268 [trainer.py] => optimizer: sgd
2025-09-20 18:43:51,268 [trainer.py] => lrate: 0.002
2025-09-20 18:43:51,268 [trainer.py] => head_scale: 1.0
2025-09-20 18:43:51,268 [trainer.py] => batch_size: 24
2025-09-20 18:43:51,268 [trainer.py] => gamma_norm: 0.1
2025-09-20 18:43:51,268 [trainer.py] => gamma_kd: 0.0
2025-09-20 18:43:51,268 [trainer.py] => kd_type: feat
2025-09-20 18:43:51,268 [trainer.py] => compensate: True
2025-09-20 18:43:51,268 [trainer.py] => eval_only: False
2025-09-20 18:43:51,268 [trainer.py] => auxiliary_data_path: /data1/open_datasets/ImageNet-2012/train
2025-09-20 18:43:51,268 [trainer.py] => aux_dataset: imagenet
2025-09-20 18:43:51,268 [trainer.py] => auxiliary_data_size: 1024
2025-09-20 18:43:51,268 [trainer.py] => l2_protection: True
2025-09-20 18:43:51,268 [trainer.py] => l2_protection_lambda: 0.0001
2025-09-20 18:43:51,269 [trainer.py] => seed: 1993
2025-09-20 18:43:51,269 [trainer.py] => run_id: 0
2025-09-20 18:43:51,269 [trainer.py] => log_path: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993
2025-09-20 18:43:51,269 [data_manager.py] => [DataManager] args_for_idata = {'dataset': 'imagenet-r', 'smart_defaults': False, 'user': 'authors', 'memory_size': 0, 'memory_per_class': 0, 'fixed_memory': False, 'shuffle': True, 'init_cls': 20, 'increment': 20, 'model_name': 'sldc', 'vit_type': 'vit-b-p16', 'weight_decay': 0.0, 'device': [device(type='cuda', index=0)], 'lora_rank': 4, 'lora_type': 'sgp_lora', 'weight_temp': 5.0, 'weight_kind': 'log1p', 'weight_p': 1.0, 'nsp_eps': 0.05, 'nsp_weight': 0.0, 'sce_a': 0.5, 'sce_b': 0.5, 'seed_list': [1993], 'iterations': 20, 'warmup_steps': 200, 'ca_epochs': 5, 'optimizer': 'sgd', 'lrate': 0.002, 'head_scale': 1.0, 'batch_size': 24, 'gamma_norm': 0.1, 'gamma_kd': 0.0, 'kd_type': 'feat', 'compensate': True, 'eval_only': False, 'auxiliary_data_path': '/data1/open_datasets/ImageNet-2012/train', 'aux_dataset': 'imagenet', 'auxiliary_data_size': 1024, 'l2_protection': True, 'l2_protection_lambda': 0.0001, 'seed': 1993, 'run_id': 0, 'log_path': 'sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993'}
2025-09-20 18:43:51,342 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2025-09-20 18:43:52,755 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-09-20 18:43:53,341 [_hub.py] => [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-09-20 18:44:10,251 [subspace_lora.py] => Compiled network with torch.compile
2025-09-20 18:44:41,473 [trainer.py] => dataset: imagenet-r
2025-09-20 18:44:41,473 [trainer.py] => smart_defaults: False
2025-09-20 18:44:41,473 [trainer.py] => user: authors
2025-09-20 18:44:41,474 [trainer.py] => memory_size: 0
2025-09-20 18:44:41,474 [trainer.py] => memory_per_class: 0
2025-09-20 18:44:41,474 [trainer.py] => fixed_memory: False
2025-09-20 18:44:41,474 [trainer.py] => shuffle: True
2025-09-20 18:44:41,474 [trainer.py] => init_cls: 20
2025-09-20 18:44:41,474 [trainer.py] => increment: 20
2025-09-20 18:44:41,474 [trainer.py] => model_name: sldc
2025-09-20 18:44:41,474 [trainer.py] => vit_type: vit-b-p16
2025-09-20 18:44:41,474 [trainer.py] => weight_decay: 0.0
2025-09-20 18:44:41,474 [trainer.py] => device: [device(type='cuda', index=0)]
2025-09-20 18:44:41,474 [trainer.py] => lora_rank: 4
2025-09-20 18:44:41,474 [trainer.py] => lora_type: sgp_lora
2025-09-20 18:44:41,474 [trainer.py] => weight_temp: 5.0
2025-09-20 18:44:41,474 [trainer.py] => weight_kind: log1p
2025-09-20 18:44:41,474 [trainer.py] => weight_p: 1.0
2025-09-20 18:44:41,474 [trainer.py] => nsp_eps: 0.05
2025-09-20 18:44:41,474 [trainer.py] => nsp_weight: 0.0
2025-09-20 18:44:41,474 [trainer.py] => sce_a: 0.5
2025-09-20 18:44:41,474 [trainer.py] => sce_b: 0.5
2025-09-20 18:44:41,474 [trainer.py] => seed_list: [1993]
2025-09-20 18:44:41,474 [trainer.py] => iterations: 20
2025-09-20 18:44:41,474 [trainer.py] => warmup_steps: 200
2025-09-20 18:44:41,474 [trainer.py] => ca_epochs: 5
2025-09-20 18:44:41,474 [trainer.py] => optimizer: sgd
2025-09-20 18:44:41,474 [trainer.py] => lrate: 0.002
2025-09-20 18:44:41,474 [trainer.py] => batch_size: 24
2025-09-20 18:44:41,474 [trainer.py] => gamma_norm: 0.1
2025-09-20 18:44:41,474 [trainer.py] => gamma_kd: 0.0
2025-09-20 18:44:41,474 [trainer.py] => kd_type: feat
2025-09-20 18:44:41,474 [trainer.py] => compensate: True
2025-09-20 18:44:41,474 [trainer.py] => eval_only: False
2025-09-20 18:44:41,475 [trainer.py] => auxiliary_data_path: /data1/open_datasets/ImageNet-2012/train
2025-09-20 18:44:41,475 [trainer.py] => aux_dataset: imagenet
2025-09-20 18:44:41,475 [trainer.py] => auxiliary_data_size: 1024
2025-09-20 18:44:41,475 [trainer.py] => l2_protection: True
2025-09-20 18:44:41,475 [trainer.py] => l2_protection_lambda: 0.0001
2025-09-20 18:44:41,475 [trainer.py] => seed: 1993
2025-09-20 18:44:41,475 [trainer.py] => run_id: 0
2025-09-20 18:44:41,475 [trainer.py] => log_path: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993
2025-09-20 18:44:41,475 [data_manager.py] => [DataManager] args_for_idata = {'dataset': 'imagenet-r', 'smart_defaults': False, 'user': 'authors', 'memory_size': 0, 'memory_per_class': 0, 'fixed_memory': False, 'shuffle': True, 'init_cls': 20, 'increment': 20, 'model_name': 'sldc', 'vit_type': 'vit-b-p16', 'weight_decay': 0.0, 'device': [device(type='cuda', index=0)], 'lora_rank': 4, 'lora_type': 'sgp_lora', 'weight_temp': 5.0, 'weight_kind': 'log1p', 'weight_p': 1.0, 'nsp_eps': 0.05, 'nsp_weight': 0.0, 'sce_a': 0.5, 'sce_b': 0.5, 'seed_list': [1993], 'iterations': 20, 'warmup_steps': 200, 'ca_epochs': 5, 'optimizer': 'sgd', 'lrate': 0.002, 'batch_size': 24, 'gamma_norm': 0.1, 'gamma_kd': 0.0, 'kd_type': 'feat', 'compensate': True, 'eval_only': False, 'auxiliary_data_path': '/data1/open_datasets/ImageNet-2012/train', 'aux_dataset': 'imagenet', 'auxiliary_data_size': 1024, 'l2_protection': True, 'l2_protection_lambda': 0.0001, 'seed': 1993, 'run_id': 0, 'log_path': 'sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993'}
2025-09-20 18:44:41,549 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2025-09-20 18:44:42,849 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-09-20 18:44:43,426 [_hub.py] => [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-09-20 18:45:01,710 [subspace_lora.py] => Compiled network with torch.compile
2025-09-20 18:45:01,711 [subspace_lora.py] => Optimizer instantiated: lrate=0.002, wd=0.0, optimizer=sgd
2025-09-20 18:45:01,712 [trainer.py] => All params: 86469888
2025-09-20 18:45:01,712 [trainer.py] => Trainable params: 672768
2025-09-20 18:45:53,643 [trainer.py] => dataset: imagenet-r
2025-09-20 18:45:53,643 [trainer.py] => smart_defaults: False
2025-09-20 18:45:53,643 [trainer.py] => user: authors
2025-09-20 18:45:53,643 [trainer.py] => memory_size: 0
2025-09-20 18:45:53,643 [trainer.py] => memory_per_class: 0
2025-09-20 18:45:53,643 [trainer.py] => fixed_memory: False
2025-09-20 18:45:53,643 [trainer.py] => shuffle: True
2025-09-20 18:45:53,643 [trainer.py] => init_cls: 20
2025-09-20 18:45:53,643 [trainer.py] => increment: 20
2025-09-20 18:45:53,643 [trainer.py] => model_name: sldc
2025-09-20 18:45:53,643 [trainer.py] => vit_type: vit-b-p16
2025-09-20 18:45:53,643 [trainer.py] => weight_decay: 0.0
2025-09-20 18:45:53,643 [trainer.py] => device: [device(type='cuda', index=0)]
2025-09-20 18:45:53,643 [trainer.py] => lora_rank: 4
2025-09-20 18:45:53,643 [trainer.py] => lora_type: sgp_lora
2025-09-20 18:45:53,644 [trainer.py] => weight_temp: 5.0
2025-09-20 18:45:53,644 [trainer.py] => weight_kind: log1p
2025-09-20 18:45:53,644 [trainer.py] => weight_p: 1.0
2025-09-20 18:45:53,644 [trainer.py] => nsp_eps: 0.05
2025-09-20 18:45:53,644 [trainer.py] => nsp_weight: 0.0
2025-09-20 18:45:53,644 [trainer.py] => sce_a: 0.5
2025-09-20 18:45:53,644 [trainer.py] => sce_b: 0.5
2025-09-20 18:45:53,644 [trainer.py] => seed_list: [1993]
2025-09-20 18:45:53,644 [trainer.py] => iterations: 20
2025-09-20 18:45:53,644 [trainer.py] => warmup_steps: 200
2025-09-20 18:45:53,644 [trainer.py] => ca_epochs: 5
2025-09-20 18:45:53,644 [trainer.py] => optimizer: sgd
2025-09-20 18:45:53,644 [trainer.py] => lrate: 0.002
2025-09-20 18:45:53,644 [trainer.py] => batch_size: 24
2025-09-20 18:45:53,644 [trainer.py] => gamma_norm: 0.1
2025-09-20 18:45:53,644 [trainer.py] => gamma_kd: 0.0
2025-09-20 18:45:53,644 [trainer.py] => kd_type: feat
2025-09-20 18:45:53,644 [trainer.py] => compensate: True
2025-09-20 18:45:53,644 [trainer.py] => eval_only: False
2025-09-20 18:45:53,644 [trainer.py] => auxiliary_data_path: /data1/open_datasets/ImageNet-2012/train
2025-09-20 18:45:53,644 [trainer.py] => aux_dataset: imagenet
2025-09-20 18:45:53,644 [trainer.py] => auxiliary_data_size: 1024
2025-09-20 18:45:53,644 [trainer.py] => l2_protection: True
2025-09-20 18:45:53,644 [trainer.py] => l2_protection_lambda: 0.0001
2025-09-20 18:45:53,644 [trainer.py] => seed: 1993
2025-09-20 18:45:53,644 [trainer.py] => run_id: 0
2025-09-20 18:45:53,644 [trainer.py] => log_path: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993
2025-09-20 18:45:53,644 [data_manager.py] => [DataManager] args_for_idata = {'dataset': 'imagenet-r', 'smart_defaults': False, 'user': 'authors', 'memory_size': 0, 'memory_per_class': 0, 'fixed_memory': False, 'shuffle': True, 'init_cls': 20, 'increment': 20, 'model_name': 'sldc', 'vit_type': 'vit-b-p16', 'weight_decay': 0.0, 'device': [device(type='cuda', index=0)], 'lora_rank': 4, 'lora_type': 'sgp_lora', 'weight_temp': 5.0, 'weight_kind': 'log1p', 'weight_p': 1.0, 'nsp_eps': 0.05, 'nsp_weight': 0.0, 'sce_a': 0.5, 'sce_b': 0.5, 'seed_list': [1993], 'iterations': 20, 'warmup_steps': 200, 'ca_epochs': 5, 'optimizer': 'sgd', 'lrate': 0.002, 'batch_size': 24, 'gamma_norm': 0.1, 'gamma_kd': 0.0, 'kd_type': 'feat', 'compensate': True, 'eval_only': False, 'auxiliary_data_path': '/data1/open_datasets/ImageNet-2012/train', 'aux_dataset': 'imagenet', 'auxiliary_data_size': 1024, 'l2_protection': True, 'l2_protection_lambda': 0.0001, 'seed': 1993, 'run_id': 0, 'log_path': 'sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993'}
2025-09-20 18:45:53,717 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2025-09-20 18:45:55,130 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-09-20 18:45:55,761 [_hub.py] => [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-09-20 18:46:13,371 [subspace_lora.py] => Compiled network with torch.compile
2025-09-20 18:46:13,371 [subspace_lora.py] => Optimizer instantiated: lrate=0.002, wd=0.0, optimizer=sgd
2025-09-20 18:46:13,372 [trainer.py] => All params: 86469888
2025-09-20 18:46:13,373 [trainer.py] => Trainable params: 672768
2025-09-20 18:46:13,379 [subspace_lora.py] => System training on classes 0-20 (imagenet-r)
2025-09-20 18:46:16,007 [subspace_lora.py] => Checkpoint saved to: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993/after_task_1.pth
2025-09-20 18:48:16,726 [trainer.py] => dataset: imagenet-r
2025-09-20 18:48:16,726 [trainer.py] => smart_defaults: False
2025-09-20 18:48:16,726 [trainer.py] => user: authors
2025-09-20 18:48:16,726 [trainer.py] => memory_size: 0
2025-09-20 18:48:16,726 [trainer.py] => memory_per_class: 0
2025-09-20 18:48:16,726 [trainer.py] => fixed_memory: False
2025-09-20 18:48:16,726 [trainer.py] => shuffle: True
2025-09-20 18:48:16,726 [trainer.py] => init_cls: 20
2025-09-20 18:48:16,726 [trainer.py] => increment: 20
2025-09-20 18:48:16,726 [trainer.py] => model_name: sldc
2025-09-20 18:48:16,726 [trainer.py] => vit_type: vit-b-p16
2025-09-20 18:48:16,726 [trainer.py] => weight_decay: 0.0
2025-09-20 18:48:16,726 [trainer.py] => device: [device(type='cuda', index=0)]
2025-09-20 18:48:16,726 [trainer.py] => lora_rank: 4
2025-09-20 18:48:16,726 [trainer.py] => lora_type: sgp_lora
2025-09-20 18:48:16,726 [trainer.py] => weight_temp: 5.0
2025-09-20 18:48:16,726 [trainer.py] => weight_kind: log1p
2025-09-20 18:48:16,726 [trainer.py] => weight_p: 1.0
2025-09-20 18:48:16,726 [trainer.py] => nsp_eps: 0.05
2025-09-20 18:48:16,726 [trainer.py] => nsp_weight: 0.0
2025-09-20 18:48:16,726 [trainer.py] => sce_a: 0.5
2025-09-20 18:48:16,726 [trainer.py] => sce_b: 0.5
2025-09-20 18:48:16,726 [trainer.py] => seed_list: [1993]
2025-09-20 18:48:16,726 [trainer.py] => iterations: 20
2025-09-20 18:48:16,726 [trainer.py] => warmup_steps: 200
2025-09-20 18:48:16,726 [trainer.py] => ca_epochs: 5
2025-09-20 18:48:16,726 [trainer.py] => optimizer: sgd
2025-09-20 18:48:16,727 [trainer.py] => lrate: 0.002
2025-09-20 18:48:16,727 [trainer.py] => batch_size: 24
2025-09-20 18:48:16,727 [trainer.py] => gamma_norm: 0.1
2025-09-20 18:48:16,727 [trainer.py] => gamma_kd: 0.0
2025-09-20 18:48:16,727 [trainer.py] => kd_type: feat
2025-09-20 18:48:16,727 [trainer.py] => compensate: True
2025-09-20 18:48:16,727 [trainer.py] => eval_only: False
2025-09-20 18:48:16,727 [trainer.py] => auxiliary_data_path: /data1/open_datasets/ImageNet-2012/train
2025-09-20 18:48:16,727 [trainer.py] => aux_dataset: imagenet
2025-09-20 18:48:16,727 [trainer.py] => auxiliary_data_size: 1024
2025-09-20 18:48:16,727 [trainer.py] => l2_protection: True
2025-09-20 18:48:16,727 [trainer.py] => l2_protection_lambda: 0.0001
2025-09-20 18:48:16,727 [trainer.py] => seed: 1993
2025-09-20 18:48:16,727 [trainer.py] => run_id: 0
2025-09-20 18:48:16,727 [trainer.py] => log_path: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993
2025-09-20 18:48:16,727 [data_manager.py] => [DataManager] args_for_idata = {'dataset': 'imagenet-r', 'smart_defaults': False, 'user': 'authors', 'memory_size': 0, 'memory_per_class': 0, 'fixed_memory': False, 'shuffle': True, 'init_cls': 20, 'increment': 20, 'model_name': 'sldc', 'vit_type': 'vit-b-p16', 'weight_decay': 0.0, 'device': [device(type='cuda', index=0)], 'lora_rank': 4, 'lora_type': 'sgp_lora', 'weight_temp': 5.0, 'weight_kind': 'log1p', 'weight_p': 1.0, 'nsp_eps': 0.05, 'nsp_weight': 0.0, 'sce_a': 0.5, 'sce_b': 0.5, 'seed_list': [1993], 'iterations': 20, 'warmup_steps': 200, 'ca_epochs': 5, 'optimizer': 'sgd', 'lrate': 0.002, 'batch_size': 24, 'gamma_norm': 0.1, 'gamma_kd': 0.0, 'kd_type': 'feat', 'compensate': True, 'eval_only': False, 'auxiliary_data_path': '/data1/open_datasets/ImageNet-2012/train', 'aux_dataset': 'imagenet', 'auxiliary_data_size': 1024, 'l2_protection': True, 'l2_protection_lambda': 0.0001, 'seed': 1993, 'run_id': 0, 'log_path': 'sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993'}
2025-09-20 18:48:16,802 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2025-09-20 18:48:18,210 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-09-20 18:48:18,791 [_hub.py] => [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-09-20 18:48:36,795 [subspace_lora.py] => Compiled network with torch.compile
2025-09-20 18:48:36,796 [subspace_lora.py] => Optimizer instantiated: lrate=0.002, wd=0.0, optimizer=sgd
2025-09-20 18:48:36,796 [trainer.py] => All params: 86469888
2025-09-20 18:48:36,797 [trainer.py] => Trainable params: 672768
2025-09-20 18:50:03,909 [trainer.py] => dataset: imagenet-r
2025-09-20 18:50:03,909 [trainer.py] => smart_defaults: False
2025-09-20 18:50:03,909 [trainer.py] => user: authors
2025-09-20 18:50:03,909 [trainer.py] => memory_size: 0
2025-09-20 18:50:03,909 [trainer.py] => memory_per_class: 0
2025-09-20 18:50:03,909 [trainer.py] => fixed_memory: False
2025-09-20 18:50:03,909 [trainer.py] => shuffle: True
2025-09-20 18:50:03,909 [trainer.py] => init_cls: 20
2025-09-20 18:50:03,909 [trainer.py] => increment: 20
2025-09-20 18:50:03,909 [trainer.py] => model_name: sldc
2025-09-20 18:50:03,909 [trainer.py] => vit_type: vit-b-p16
2025-09-20 18:50:03,909 [trainer.py] => weight_decay: 0.0
2025-09-20 18:50:03,909 [trainer.py] => device: [device(type='cuda', index=0)]
2025-09-20 18:50:03,909 [trainer.py] => lora_rank: 4
2025-09-20 18:50:03,909 [trainer.py] => lora_type: sgp_lora
2025-09-20 18:50:03,910 [trainer.py] => weight_temp: 5.0
2025-09-20 18:50:03,910 [trainer.py] => weight_kind: log1p
2025-09-20 18:50:03,910 [trainer.py] => weight_p: 1.0
2025-09-20 18:50:03,910 [trainer.py] => nsp_eps: 0.05
2025-09-20 18:50:03,910 [trainer.py] => nsp_weight: 0.0
2025-09-20 18:50:03,910 [trainer.py] => sce_a: 0.5
2025-09-20 18:50:03,910 [trainer.py] => sce_b: 0.5
2025-09-20 18:50:03,910 [trainer.py] => seed_list: [1993]
2025-09-20 18:50:03,910 [trainer.py] => iterations: 20
2025-09-20 18:50:03,910 [trainer.py] => warmup_steps: 200
2025-09-20 18:50:03,910 [trainer.py] => ca_epochs: 5
2025-09-20 18:50:03,910 [trainer.py] => optimizer: sgd
2025-09-20 18:50:03,910 [trainer.py] => lrate: 0.002
2025-09-20 18:50:03,910 [trainer.py] => batch_size: 24
2025-09-20 18:50:03,910 [trainer.py] => gamma_norm: 0.1
2025-09-20 18:50:03,910 [trainer.py] => gamma_kd: 0.0
2025-09-20 18:50:03,910 [trainer.py] => kd_type: feat
2025-09-20 18:50:03,910 [trainer.py] => compensate: True
2025-09-20 18:50:03,910 [trainer.py] => eval_only: False
2025-09-20 18:50:03,910 [trainer.py] => auxiliary_data_path: /data1/open_datasets/ImageNet-2012/train
2025-09-20 18:50:03,910 [trainer.py] => aux_dataset: imagenet
2025-09-20 18:50:03,910 [trainer.py] => auxiliary_data_size: 1024
2025-09-20 18:50:03,910 [trainer.py] => l2_protection: True
2025-09-20 18:50:03,910 [trainer.py] => l2_protection_lambda: 0.0001
2025-09-20 18:50:03,910 [trainer.py] => seed: 1993
2025-09-20 18:50:03,910 [trainer.py] => run_id: 0
2025-09-20 18:50:03,910 [trainer.py] => log_path: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993
2025-09-20 18:50:03,910 [data_manager.py] => [DataManager] args_for_idata = {'dataset': 'imagenet-r', 'smart_defaults': False, 'user': 'authors', 'memory_size': 0, 'memory_per_class': 0, 'fixed_memory': False, 'shuffle': True, 'init_cls': 20, 'increment': 20, 'model_name': 'sldc', 'vit_type': 'vit-b-p16', 'weight_decay': 0.0, 'device': [device(type='cuda', index=0)], 'lora_rank': 4, 'lora_type': 'sgp_lora', 'weight_temp': 5.0, 'weight_kind': 'log1p', 'weight_p': 1.0, 'nsp_eps': 0.05, 'nsp_weight': 0.0, 'sce_a': 0.5, 'sce_b': 0.5, 'seed_list': [1993], 'iterations': 20, 'warmup_steps': 200, 'ca_epochs': 5, 'optimizer': 'sgd', 'lrate': 0.002, 'batch_size': 24, 'gamma_norm': 0.1, 'gamma_kd': 0.0, 'kd_type': 'feat', 'compensate': True, 'eval_only': False, 'auxiliary_data_path': '/data1/open_datasets/ImageNet-2012/train', 'aux_dataset': 'imagenet', 'auxiliary_data_size': 1024, 'l2_protection': True, 'l2_protection_lambda': 0.0001, 'seed': 1993, 'run_id': 0, 'log_path': 'sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993'}
2025-09-20 18:50:03,983 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2025-09-20 18:50:05,342 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-09-20 18:50:05,931 [_hub.py] => [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-09-20 18:50:20,439 [subspace_lora.py] => Compiled network with torch.compile
2025-09-20 18:50:20,439 [subspace_lora.py] => Optimizer instantiated: lrate=0.002, wd=0.0, optimizer=sgd
2025-09-20 18:50:20,440 [trainer.py] => All params: 86469888
2025-09-20 18:50:20,440 [trainer.py] => Trainable params: 672768
2025-09-20 18:50:20,527 [subspace_lora.py] => System training on classes 0-20 (imagenet-r)
2025-09-20 18:50:23,205 [subspace_lora.py] => Checkpoint saved to: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993/after_task_1.pth
2025-09-20 18:50:39,086 [subspace_lora.py] => Task 1 finished â€“ total: 18.65 s | train: 2.66 s | drift: 15.88 s
2025-09-20 18:50:40,486 [subspace_lora.py] => Evaluating after task 1...
2025-09-20 18:50:42,207 [subspace_lora.py] => ğŸ“Š Incremental Learning Evaluation Analysis:
2025-09-20 18:50:42,207 [subspace_lora.py] =>    Last Task ID: 1
2025-09-20 18:50:42,207 [subspace_lora.py] =>   â”€â”€ Final Task Accuracy (%) â”€â”€
2025-09-20 18:50:42,207 [subspace_lora.py] =>       per-class            : 78.81%
2025-09-20 18:50:42,207 [subspace_lora.py] =>       per-class_compensate : 77.65%
2025-09-20 18:50:42,207 [subspace_lora.py] =>    â”€â”€ Average Accuracy Across Tasks (%) â”€â”€
2025-09-20 18:50:42,207 [subspace_lora.py] =>       per-class            : 78.81%
2025-09-20 18:50:42,207 [subspace_lora.py] =>       per-class_compensate : 77.65%
2025-09-20 18:50:42,207 [subspace_lora.py] =>    â”€â”€ Summary â”€â”€
2025-09-20 18:50:42,207 [subspace_lora.py] =>       ğŸ† Variant 'per-class' is best in both final task and average performance.
2025-09-20 18:50:51,267 [subspace_lora.py] => System training on classes 20-40 (imagenet-r)
2025-09-20 18:50:53,445 [subspace_lora.py] => Checkpoint saved to: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993/after_task_2.pth
2025-09-20 18:51:06,587 [subspace_lora.py] => Task 2 finished â€“ total: 15.67 s | train: 2.16 s | drift: 13.14 s
2025-09-20 18:51:09,362 [subspace_lora.py] => Evaluating after task 2...
2025-09-20 18:51:12,346 [subspace_lora.py] => ğŸ“Š Incremental Learning Evaluation Analysis:
2025-09-20 18:51:12,346 [subspace_lora.py] =>    Last Task ID: 2
2025-09-20 18:51:12,346 [subspace_lora.py] =>   â”€â”€ Final Task Accuracy (%) â”€â”€
2025-09-20 18:51:12,346 [subspace_lora.py] =>       per-class            : 72.14%
2025-09-20 18:51:12,346 [subspace_lora.py] =>       per-class_compensate : 71.76%
2025-09-20 18:51:12,346 [subspace_lora.py] =>    â”€â”€ Average Accuracy Across Tasks (%) â”€â”€
2025-09-20 18:51:12,346 [subspace_lora.py] =>       per-class            : 75.47%
2025-09-20 18:51:12,346 [subspace_lora.py] =>       per-class_compensate : 74.71%
2025-09-20 18:51:12,346 [subspace_lora.py] =>    â”€â”€ Summary â”€â”€
2025-09-20 18:51:12,346 [subspace_lora.py] =>       ğŸ† Variant 'per-class' is best in both final task and average performance.
2025-09-20 18:51:20,358 [subspace_lora.py] => System training on classes 40-60 (imagenet-r)
2025-09-20 18:51:23,232 [subspace_lora.py] => Checkpoint saved to: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993/after_task_3.pth
2025-09-20 18:51:38,203 [subspace_lora.py] => Task 3 finished â€“ total: 18.21 s | train: 2.84 s | drift: 14.97 s
2025-09-20 18:51:42,403 [subspace_lora.py] => Evaluating after task 3...
2025-09-20 18:51:46,484 [subspace_lora.py] => ğŸ“Š Incremental Learning Evaluation Analysis:
2025-09-20 18:51:46,485 [subspace_lora.py] =>    Last Task ID: 3
2025-09-20 18:51:46,485 [subspace_lora.py] =>   â”€â”€ Final Task Accuracy (%) â”€â”€
2025-09-20 18:51:46,485 [subspace_lora.py] =>       per-class            : 66.27%
2025-09-20 18:51:46,485 [subspace_lora.py] =>       per-class_compensate : 66.11%
2025-09-20 18:51:46,485 [subspace_lora.py] =>    â”€â”€ Average Accuracy Across Tasks (%) â”€â”€
2025-09-20 18:51:46,485 [subspace_lora.py] =>       per-class            : 72.41%
2025-09-20 18:51:46,485 [subspace_lora.py] =>       per-class_compensate : 71.84%
2025-09-20 18:51:46,485 [subspace_lora.py] =>    â”€â”€ Summary â”€â”€
2025-09-20 18:51:46,485 [subspace_lora.py] =>       ğŸ† Variant 'per-class' is best in both final task and average performance.
2025-09-20 18:51:54,358 [subspace_lora.py] => System training on classes 60-80 (imagenet-r)
2025-09-20 18:51:56,634 [subspace_lora.py] => Checkpoint saved to: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993/after_task_4.pth
2025-09-20 18:52:13,682 [subspace_lora.py] => Task 4 finished â€“ total: 19.73 s | train: 2.26 s | drift: 17.05 s
2025-09-20 18:52:20,054 [subspace_lora.py] => Evaluating after task 4...
2025-09-20 18:52:25,239 [subspace_lora.py] => ğŸ“Š Incremental Learning Evaluation Analysis:
2025-09-20 18:52:25,239 [subspace_lora.py] =>    Last Task ID: 4
2025-09-20 18:52:25,239 [subspace_lora.py] =>   â”€â”€ Final Task Accuracy (%) â”€â”€
2025-09-20 18:52:25,239 [subspace_lora.py] =>       per-class            : 63.69%
2025-09-20 18:52:25,239 [subspace_lora.py] =>       per-class_compensate : 63.85%
2025-09-20 18:52:25,239 [subspace_lora.py] =>    â”€â”€ Average Accuracy Across Tasks (%) â”€â”€
2025-09-20 18:52:25,239 [subspace_lora.py] =>       per-class            : 70.23%
2025-09-20 18:52:25,239 [subspace_lora.py] =>       per-class_compensate : 69.84%
2025-09-20 18:52:25,239 [subspace_lora.py] =>    â”€â”€ Summary â”€â”€
2025-09-20 18:52:25,239 [subspace_lora.py] =>       ğŸ¥‡ Best in Final Task: 'per-class_compensate' | ğŸ“ˆ Best Average: 'per-class'
2025-09-20 18:52:32,955 [subspace_lora.py] => System training on classes 80-100 (imagenet-r)
2025-09-20 18:52:35,384 [subspace_lora.py] => Checkpoint saved to: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993/after_task_5.pth
2025-09-20 18:52:53,927 [subspace_lora.py] => Task 5 finished â€“ total: 21.58 s | train: 2.41 s | drift: 18.54 s
2025-09-20 18:53:02,272 [subspace_lora.py] => Evaluating after task 5...
2025-09-20 18:53:08,257 [subspace_lora.py] => ğŸ“Š Incremental Learning Evaluation Analysis:
2025-09-20 18:53:08,257 [subspace_lora.py] =>    Last Task ID: 5
2025-09-20 18:53:08,257 [subspace_lora.py] =>   â”€â”€ Final Task Accuracy (%) â”€â”€
2025-09-20 18:53:08,257 [subspace_lora.py] =>       per-class            : 62.35%
2025-09-20 18:53:08,258 [subspace_lora.py] =>       per-class_compensate : 62.41%
2025-09-20 18:53:08,258 [subspace_lora.py] =>    â”€â”€ Average Accuracy Across Tasks (%) â”€â”€
2025-09-20 18:53:08,258 [subspace_lora.py] =>       per-class            : 68.65%
2025-09-20 18:53:08,258 [subspace_lora.py] =>       per-class_compensate : 68.36%
2025-09-20 18:53:08,258 [subspace_lora.py] =>    â”€â”€ Summary â”€â”€
2025-09-20 18:53:08,258 [subspace_lora.py] =>       ğŸ¥‡ Best in Final Task: 'per-class_compensate' | ğŸ“ˆ Best Average: 'per-class'
2025-09-20 18:53:15,149 [subspace_lora.py] => System training on classes 100-120 (imagenet-r)
2025-09-20 18:53:17,714 [subspace_lora.py] => Checkpoint saved to: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993/after_task_6.pth
2025-09-20 18:53:42,716 [subspace_lora.py] => Task 6 finished â€“ total: 28.11 s | train: 2.54 s | drift: 25.00 s
2025-09-20 18:53:51,949 [subspace_lora.py] => Evaluating after task 6...
2025-09-20 18:53:59,010 [subspace_lora.py] => ğŸ“Š Incremental Learning Evaluation Analysis:
2025-09-20 18:53:59,010 [subspace_lora.py] =>    Last Task ID: 6
2025-09-20 18:53:59,010 [subspace_lora.py] =>   â”€â”€ Final Task Accuracy (%) â”€â”€
2025-09-20 18:53:59,010 [subspace_lora.py] =>       per-class            : 59.31%
2025-09-20 18:53:59,010 [subspace_lora.py] =>       per-class_compensate : 59.45%
2025-09-20 18:53:59,010 [subspace_lora.py] =>    â”€â”€ Average Accuracy Across Tasks (%) â”€â”€
2025-09-20 18:53:59,011 [subspace_lora.py] =>       per-class            : 67.09%
2025-09-20 18:53:59,011 [subspace_lora.py] =>       per-class_compensate : 66.87%
2025-09-20 18:53:59,011 [subspace_lora.py] =>    â”€â”€ Summary â”€â”€
2025-09-20 18:53:59,011 [subspace_lora.py] =>       ğŸ¥‡ Best in Final Task: 'per-class_compensate' | ğŸ“ˆ Best Average: 'per-class'
2025-09-20 18:54:07,945 [subspace_lora.py] => System training on classes 120-140 (imagenet-r)
2025-09-20 18:54:10,532 [subspace_lora.py] => Checkpoint saved to: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993/after_task_7.pth
2025-09-20 18:54:32,439 [subspace_lora.py] => Task 7 finished â€“ total: 25.19 s | train: 2.57 s | drift: 21.91 s
2025-09-20 18:54:44,177 [subspace_lora.py] => Evaluating after task 7...
2025-09-20 18:54:55,599 [trainer.py] => dataset: imagenet-r
2025-09-20 18:54:55,599 [trainer.py] => smart_defaults: False
2025-09-20 18:54:55,599 [trainer.py] => user: authors
2025-09-20 18:54:55,599 [trainer.py] => memory_size: 0
2025-09-20 18:54:55,599 [trainer.py] => memory_per_class: 0
2025-09-20 18:54:55,599 [trainer.py] => fixed_memory: False
2025-09-20 18:54:55,599 [trainer.py] => shuffle: True
2025-09-20 18:54:55,599 [trainer.py] => init_cls: 20
2025-09-20 18:54:55,599 [trainer.py] => increment: 20
2025-09-20 18:54:55,599 [trainer.py] => model_name: sldc
2025-09-20 18:54:55,599 [trainer.py] => vit_type: vit-b-p16
2025-09-20 18:54:55,599 [trainer.py] => weight_decay: 0.0
2025-09-20 18:54:55,599 [trainer.py] => device: [device(type='cuda', index=0)]
2025-09-20 18:54:55,599 [trainer.py] => lora_rank: 4
2025-09-20 18:54:55,599 [trainer.py] => lora_type: sgp_lora
2025-09-20 18:54:55,599 [trainer.py] => weight_temp: 5.0
2025-09-20 18:54:55,599 [trainer.py] => weight_kind: log1p
2025-09-20 18:54:55,599 [trainer.py] => weight_p: 1.0
2025-09-20 18:54:55,599 [trainer.py] => nsp_eps: 0.05
2025-09-20 18:54:55,599 [trainer.py] => nsp_weight: 0.0
2025-09-20 18:54:55,599 [trainer.py] => sce_a: 0.5
2025-09-20 18:54:55,600 [trainer.py] => sce_b: 0.5
2025-09-20 18:54:55,600 [trainer.py] => seed_list: [1993]
2025-09-20 18:54:55,600 [trainer.py] => iterations: 20
2025-09-20 18:54:55,600 [trainer.py] => warmup_steps: 200
2025-09-20 18:54:55,600 [trainer.py] => ca_epochs: 5
2025-09-20 18:54:55,600 [trainer.py] => optimizer: sgd
2025-09-20 18:54:55,600 [trainer.py] => lrate: 0.002
2025-09-20 18:54:55,600 [trainer.py] => batch_size: 24
2025-09-20 18:54:55,600 [trainer.py] => gamma_norm: 0.1
2025-09-20 18:54:55,600 [trainer.py] => gamma_kd: 0.0
2025-09-20 18:54:55,600 [trainer.py] => kd_type: feat
2025-09-20 18:54:55,600 [trainer.py] => compensate: True
2025-09-20 18:54:55,600 [trainer.py] => eval_only: False
2025-09-20 18:54:55,600 [trainer.py] => auxiliary_data_path: /data1/open_datasets/ImageNet-2012/train
2025-09-20 18:54:55,600 [trainer.py] => aux_dataset: imagenet
2025-09-20 18:54:55,600 [trainer.py] => auxiliary_data_size: 1024
2025-09-20 18:54:55,600 [trainer.py] => l2_protection: True
2025-09-20 18:54:55,600 [trainer.py] => l2_protection_lambda: 0.0001
2025-09-20 18:54:55,600 [trainer.py] => seed: 1993
2025-09-20 18:54:55,600 [trainer.py] => run_id: 0
2025-09-20 18:54:55,600 [trainer.py] => log_path: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993
2025-09-20 18:54:55,600 [data_manager.py] => [DataManager] args_for_idata = {'dataset': 'imagenet-r', 'smart_defaults': False, 'user': 'authors', 'memory_size': 0, 'memory_per_class': 0, 'fixed_memory': False, 'shuffle': True, 'init_cls': 20, 'increment': 20, 'model_name': 'sldc', 'vit_type': 'vit-b-p16', 'weight_decay': 0.0, 'device': [device(type='cuda', index=0)], 'lora_rank': 4, 'lora_type': 'sgp_lora', 'weight_temp': 5.0, 'weight_kind': 'log1p', 'weight_p': 1.0, 'nsp_eps': 0.05, 'nsp_weight': 0.0, 'sce_a': 0.5, 'sce_b': 0.5, 'seed_list': [1993], 'iterations': 20, 'warmup_steps': 200, 'ca_epochs': 5, 'optimizer': 'sgd', 'lrate': 0.002, 'batch_size': 24, 'gamma_norm': 0.1, 'gamma_kd': 0.0, 'kd_type': 'feat', 'compensate': True, 'eval_only': False, 'auxiliary_data_path': '/data1/open_datasets/ImageNet-2012/train', 'aux_dataset': 'imagenet', 'auxiliary_data_size': 1024, 'l2_protection': True, 'l2_protection_lambda': 0.0001, 'seed': 1993, 'run_id': 0, 'log_path': 'sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993'}
2025-09-20 18:54:55,673 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2025-09-20 18:54:57,112 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-09-20 18:54:57,717 [_hub.py] => [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-09-20 18:55:14,557 [subspace_lora.py] => Compiled network with torch.compile
2025-09-20 18:55:14,557 [subspace_lora.py] => Optimizer instantiated: lrate=0.002, wd=0.0, optimizer=sgd
2025-09-20 18:55:14,558 [trainer.py] => All params: 86469888
2025-09-20 18:55:14,559 [trainer.py] => Trainable params: 672768
2025-09-20 18:55:14,649 [subspace_lora.py] => System training on classes 0-20 (imagenet-r)
2025-09-20 18:55:17,484 [subspace_lora.py] => Checkpoint saved to: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993/after_task_1.pth
2025-09-20 18:55:27,507 [subspace_lora.py] => Task 1 finished â€“ total: 12.95 s | train: 2.81 s | drift: 10.02 s
2025-09-20 18:55:28,956 [subspace_lora.py] => Evaluating after task 1...
2025-09-20 18:55:30,612 [subspace_lora.py] => ğŸ“Š Incremental Learning Evaluation Analysis:
2025-09-20 18:55:30,612 [subspace_lora.py] =>    Last Task ID: 1
2025-09-20 18:55:30,612 [subspace_lora.py] =>   â”€â”€ Final Task Accuracy (%) â”€â”€
2025-09-20 18:55:30,612 [subspace_lora.py] =>       per-class            : 78.81%
2025-09-20 18:55:30,612 [subspace_lora.py] =>       per-class_compensate : 77.65%
2025-09-20 18:55:30,612 [subspace_lora.py] =>    â”€â”€ Average Accuracy Across Tasks (%) â”€â”€
2025-09-20 18:55:30,612 [subspace_lora.py] =>       per-class            : 78.81%
2025-09-20 18:55:30,612 [subspace_lora.py] =>       per-class_compensate : 77.65%
2025-09-20 18:55:30,612 [subspace_lora.py] =>    â”€â”€ Summary â”€â”€
2025-09-20 18:55:30,612 [subspace_lora.py] =>       ğŸ† Variant 'per-class' is best in both final task and average performance.
2025-09-20 18:55:39,333 [subspace_lora.py] => System training on classes 20-40 (imagenet-r)
2025-09-20 18:55:41,642 [subspace_lora.py] => Checkpoint saved to: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993/after_task_2.pth
2025-09-20 19:02:34,596 [trainer.py] => dataset: imagenet-r
2025-09-20 19:02:34,596 [trainer.py] => smart_defaults: False
2025-09-20 19:02:34,596 [trainer.py] => user: authors
2025-09-20 19:02:34,596 [trainer.py] => memory_size: 0
2025-09-20 19:02:34,596 [trainer.py] => memory_per_class: 0
2025-09-20 19:02:34,596 [trainer.py] => fixed_memory: False
2025-09-20 19:02:34,596 [trainer.py] => shuffle: True
2025-09-20 19:02:34,596 [trainer.py] => init_cls: 20
2025-09-20 19:02:34,596 [trainer.py] => increment: 20
2025-09-20 19:02:34,596 [trainer.py] => model_name: sldc
2025-09-20 19:02:34,596 [trainer.py] => vit_type: vit-b-p16
2025-09-20 19:02:34,596 [trainer.py] => weight_decay: 0.0
2025-09-20 19:02:34,597 [trainer.py] => device: [device(type='cuda', index=0)]
2025-09-20 19:02:34,597 [trainer.py] => lora_rank: 4
2025-09-20 19:02:34,597 [trainer.py] => lora_type: sgp_lora
2025-09-20 19:02:34,597 [trainer.py] => weight_temp: 5.0
2025-09-20 19:02:34,597 [trainer.py] => weight_kind: log1p
2025-09-20 19:02:34,597 [trainer.py] => weight_p: 1.0
2025-09-20 19:02:34,597 [trainer.py] => nsp_eps: 0.05
2025-09-20 19:02:34,597 [trainer.py] => nsp_weight: 0.0
2025-09-20 19:02:34,597 [trainer.py] => sce_a: 0.5
2025-09-20 19:02:34,597 [trainer.py] => sce_b: 0.5
2025-09-20 19:02:34,597 [trainer.py] => seed_list: [1993]
2025-09-20 19:02:34,597 [trainer.py] => iterations: 20
2025-09-20 19:02:34,597 [trainer.py] => warmup_steps: 200
2025-09-20 19:02:34,597 [trainer.py] => ca_epochs: 5
2025-09-20 19:02:34,597 [trainer.py] => optimizer: sgd
2025-09-20 19:02:34,597 [trainer.py] => lrate: 0.002
2025-09-20 19:02:34,597 [trainer.py] => batch_size: 24
2025-09-20 19:02:34,597 [trainer.py] => gamma_norm: 0.1
2025-09-20 19:02:34,597 [trainer.py] => gamma_kd: 0.0
2025-09-20 19:02:34,597 [trainer.py] => kd_type: feat
2025-09-20 19:02:34,597 [trainer.py] => compensate: True
2025-09-20 19:02:34,597 [trainer.py] => eval_only: False
2025-09-20 19:02:34,597 [trainer.py] => auxiliary_data_path: /data1/open_datasets/ImageNet-2012/train
2025-09-20 19:02:34,597 [trainer.py] => aux_dataset: imagenet
2025-09-20 19:02:34,597 [trainer.py] => auxiliary_data_size: 1024
2025-09-20 19:02:34,597 [trainer.py] => l2_protection: True
2025-09-20 19:02:34,597 [trainer.py] => l2_protection_lambda: 0.0001
2025-09-20 19:02:34,597 [trainer.py] => seed: 1993
2025-09-20 19:02:34,597 [trainer.py] => run_id: 0
2025-09-20 19:02:34,597 [trainer.py] => log_path: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993
2025-09-20 19:02:34,597 [data_manager.py] => [DataManager] args_for_idata = {'dataset': 'imagenet-r', 'smart_defaults': False, 'user': 'authors', 'memory_size': 0, 'memory_per_class': 0, 'fixed_memory': False, 'shuffle': True, 'init_cls': 20, 'increment': 20, 'model_name': 'sldc', 'vit_type': 'vit-b-p16', 'weight_decay': 0.0, 'device': [device(type='cuda', index=0)], 'lora_rank': 4, 'lora_type': 'sgp_lora', 'weight_temp': 5.0, 'weight_kind': 'log1p', 'weight_p': 1.0, 'nsp_eps': 0.05, 'nsp_weight': 0.0, 'sce_a': 0.5, 'sce_b': 0.5, 'seed_list': [1993], 'iterations': 20, 'warmup_steps': 200, 'ca_epochs': 5, 'optimizer': 'sgd', 'lrate': 0.002, 'batch_size': 24, 'gamma_norm': 0.1, 'gamma_kd': 0.0, 'kd_type': 'feat', 'compensate': True, 'eval_only': False, 'auxiliary_data_path': '/data1/open_datasets/ImageNet-2012/train', 'aux_dataset': 'imagenet', 'auxiliary_data_size': 1024, 'l2_protection': True, 'l2_protection_lambda': 0.0001, 'seed': 1993, 'run_id': 0, 'log_path': 'sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993'}
2025-09-20 19:02:34,671 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2025-09-20 19:02:36,020 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-09-20 19:02:36,675 [_hub.py] => [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-09-20 19:02:52,782 [subspace_lora.py] => Compiled network with torch.compile
2025-09-20 19:02:52,783 [subspace_lora.py] => Optimizer instantiated: lrate=0.002, wd=0.0, optimizer=sgd
2025-09-20 19:02:52,783 [trainer.py] => All params: 86469888
2025-09-20 19:02:52,784 [trainer.py] => Trainable params: 672768
2025-09-20 19:02:52,878 [subspace_lora.py] => System training on classes 0-20 (imagenet-r)
2025-09-20 19:02:55,593 [subspace_lora.py] => Checkpoint saved to: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993/after_task_1.pth
2025-09-20 19:03:05,590 [subspace_lora.py] => Task 1 finished â€“ total: 12.81 s | train: 2.70 s | drift: 10.00 s
2025-09-20 19:03:06,857 [subspace_lora.py] => Evaluating after task 1...
2025-09-20 19:03:08,527 [subspace_lora.py] => ğŸ“Š Incremental Learning Evaluation Analysis:
2025-09-20 19:03:08,527 [subspace_lora.py] =>    Last Task ID: 1
2025-09-20 19:03:08,527 [subspace_lora.py] =>   â”€â”€ Final Task Accuracy (%) â”€â”€
2025-09-20 19:03:08,527 [subspace_lora.py] =>       per-class            : 78.81%
2025-09-20 19:03:08,527 [subspace_lora.py] =>       per-class_compensate : 77.65%
2025-09-20 19:03:08,527 [subspace_lora.py] =>    â”€â”€ Average Accuracy Across Tasks (%) â”€â”€
2025-09-20 19:03:08,527 [subspace_lora.py] =>       per-class            : 78.81%
2025-09-20 19:03:08,527 [subspace_lora.py] =>       per-class_compensate : 77.65%
2025-09-20 19:03:08,527 [subspace_lora.py] =>    â”€â”€ Summary â”€â”€
2025-09-20 19:03:08,527 [subspace_lora.py] =>       ğŸ† Variant 'per-class' is best in both final task and average performance.
2025-09-20 19:03:17,204 [subspace_lora.py] => System training on classes 20-40 (imagenet-r)
2025-09-20 19:03:19,426 [subspace_lora.py] => Checkpoint saved to: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993/after_task_2.pth
2025-09-20 19:03:35,136 [subspace_lora.py] => Task 2 finished â€“ total: 18.31 s | train: 2.21 s | drift: 15.71 s
2025-09-20 19:03:37,913 [subspace_lora.py] => Evaluating after task 2...
2025-09-20 19:03:40,925 [subspace_lora.py] => ğŸ“Š Incremental Learning Evaluation Analysis:
2025-09-20 19:03:40,925 [subspace_lora.py] =>    Last Task ID: 2
2025-09-20 19:03:40,925 [subspace_lora.py] =>   â”€â”€ Final Task Accuracy (%) â”€â”€
2025-09-20 19:03:40,925 [subspace_lora.py] =>       per-class            : 71.46%
2025-09-20 19:03:40,925 [subspace_lora.py] =>       per-class_compensate : 71.23%
2025-09-20 19:03:40,925 [subspace_lora.py] =>    â”€â”€ Average Accuracy Across Tasks (%) â”€â”€
2025-09-20 19:03:40,925 [subspace_lora.py] =>       per-class            : 75.13%
2025-09-20 19:03:40,925 [subspace_lora.py] =>       per-class_compensate : 74.44%
2025-09-20 19:03:40,925 [subspace_lora.py] =>    â”€â”€ Summary â”€â”€
2025-09-20 19:03:40,925 [subspace_lora.py] =>       ğŸ† Variant 'per-class' is best in both final task and average performance.
2025-09-20 19:03:48,835 [subspace_lora.py] => System training on classes 40-60 (imagenet-r)
2025-09-20 19:03:51,249 [subspace_lora.py] => Checkpoint saved to: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993/after_task_3.pth
2025-09-20 19:07:16,322 [trainer.py] => dataset: imagenet-r
2025-09-20 19:07:16,323 [trainer.py] => smart_defaults: False
2025-09-20 19:07:16,323 [trainer.py] => user: authors
2025-09-20 19:07:16,323 [trainer.py] => memory_size: 0
2025-09-20 19:07:16,323 [trainer.py] => memory_per_class: 0
2025-09-20 19:07:16,323 [trainer.py] => fixed_memory: False
2025-09-20 19:07:16,323 [trainer.py] => shuffle: True
2025-09-20 19:07:16,323 [trainer.py] => init_cls: 20
2025-09-20 19:07:16,323 [trainer.py] => increment: 20
2025-09-20 19:07:16,323 [trainer.py] => model_name: sldc
2025-09-20 19:07:16,323 [trainer.py] => vit_type: vit-b-p16
2025-09-20 19:07:16,323 [trainer.py] => weight_decay: 0.0
2025-09-20 19:07:16,323 [trainer.py] => device: [device(type='cuda', index=0)]
2025-09-20 19:07:16,323 [trainer.py] => lora_rank: 4
2025-09-20 19:07:16,323 [trainer.py] => lora_type: sgp_lora
2025-09-20 19:07:16,323 [trainer.py] => weight_temp: 5.0
2025-09-20 19:07:16,323 [trainer.py] => weight_kind: log1p
2025-09-20 19:07:16,323 [trainer.py] => weight_p: 1.0
2025-09-20 19:07:16,323 [trainer.py] => nsp_eps: 0.05
2025-09-20 19:07:16,323 [trainer.py] => nsp_weight: 0.0
2025-09-20 19:07:16,323 [trainer.py] => sce_a: 0.5
2025-09-20 19:07:16,323 [trainer.py] => sce_b: 0.5
2025-09-20 19:07:16,323 [trainer.py] => seed_list: [1993]
2025-09-20 19:07:16,323 [trainer.py] => iterations: 20
2025-09-20 19:07:16,323 [trainer.py] => warmup_steps: 200
2025-09-20 19:07:16,323 [trainer.py] => ca_epochs: 5
2025-09-20 19:07:16,323 [trainer.py] => optimizer: sgd
2025-09-20 19:07:16,323 [trainer.py] => lrate: 0.002
2025-09-20 19:07:16,323 [trainer.py] => batch_size: 24
2025-09-20 19:07:16,323 [trainer.py] => gamma_norm: 0.1
2025-09-20 19:07:16,324 [trainer.py] => gamma_kd: 0.0
2025-09-20 19:07:16,324 [trainer.py] => kd_type: feat
2025-09-20 19:07:16,324 [trainer.py] => compensate: True
2025-09-20 19:07:16,324 [trainer.py] => eval_only: False
2025-09-20 19:07:16,324 [trainer.py] => auxiliary_data_path: /data1/open_datasets/ImageNet-2012/train
2025-09-20 19:07:16,324 [trainer.py] => aux_dataset: imagenet
2025-09-20 19:07:16,324 [trainer.py] => auxiliary_data_size: 1024
2025-09-20 19:07:16,324 [trainer.py] => l2_protection: True
2025-09-20 19:07:16,324 [trainer.py] => l2_protection_lambda: 0.0001
2025-09-20 19:07:16,324 [trainer.py] => seed: 1993
2025-09-20 19:07:16,324 [trainer.py] => run_id: 0
2025-09-20 19:07:16,324 [trainer.py] => log_path: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993
2025-09-20 19:07:16,324 [data_manager.py] => [DataManager] args_for_idata = {'dataset': 'imagenet-r', 'smart_defaults': False, 'user': 'authors', 'memory_size': 0, 'memory_per_class': 0, 'fixed_memory': False, 'shuffle': True, 'init_cls': 20, 'increment': 20, 'model_name': 'sldc', 'vit_type': 'vit-b-p16', 'weight_decay': 0.0, 'device': [device(type='cuda', index=0)], 'lora_rank': 4, 'lora_type': 'sgp_lora', 'weight_temp': 5.0, 'weight_kind': 'log1p', 'weight_p': 1.0, 'nsp_eps': 0.05, 'nsp_weight': 0.0, 'sce_a': 0.5, 'sce_b': 0.5, 'seed_list': [1993], 'iterations': 20, 'warmup_steps': 200, 'ca_epochs': 5, 'optimizer': 'sgd', 'lrate': 0.002, 'batch_size': 24, 'gamma_norm': 0.1, 'gamma_kd': 0.0, 'kd_type': 'feat', 'compensate': True, 'eval_only': False, 'auxiliary_data_path': '/data1/open_datasets/ImageNet-2012/train', 'aux_dataset': 'imagenet', 'auxiliary_data_size': 1024, 'l2_protection': True, 'l2_protection_lambda': 0.0001, 'seed': 1993, 'run_id': 0, 'log_path': 'sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993'}
2025-09-20 19:07:16,396 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2025-09-20 19:07:17,817 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-09-20 19:07:28,985 [_hub.py] => [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-09-20 19:07:44,531 [subspace_lora.py] => Compiled network with torch.compile
2025-09-20 19:07:44,531 [subspace_lora.py] => Optimizer instantiated: lrate=0.002, wd=0.0, optimizer=sgd
2025-09-20 19:07:44,532 [trainer.py] => All params: 86469888
2025-09-20 19:07:44,533 [trainer.py] => Trainable params: 672768
2025-09-20 19:07:44,619 [subspace_lora.py] => System training on classes 0-20 (imagenet-r)
2025-09-20 19:07:47,305 [subspace_lora.py] => Checkpoint saved to: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993/after_task_1.pth
2025-09-20 19:07:57,393 [subspace_lora.py] => Task 1 finished â€“ total: 12.86 s | train: 2.67 s | drift: 10.09 s
2025-09-20 19:07:58,731 [subspace_lora.py] => Evaluating after task 1...
2025-09-20 19:08:00,425 [subspace_lora.py] => ğŸ“Š Incremental Learning Evaluation Analysis:
2025-09-20 19:08:00,425 [subspace_lora.py] =>    Last Task ID: 1
2025-09-20 19:08:00,425 [subspace_lora.py] =>   â”€â”€ Final Task Accuracy (%) â”€â”€
2025-09-20 19:08:00,425 [subspace_lora.py] =>       per-class            : 78.81%
2025-09-20 19:08:00,425 [subspace_lora.py] =>       per-class_compensate : 77.65%
2025-09-20 19:08:00,425 [subspace_lora.py] =>    â”€â”€ Average Accuracy Across Tasks (%) â”€â”€
2025-09-20 19:08:00,425 [subspace_lora.py] =>       per-class            : 78.81%
2025-09-20 19:08:00,426 [subspace_lora.py] =>       per-class_compensate : 77.65%
2025-09-20 19:08:00,426 [subspace_lora.py] =>    â”€â”€ Summary â”€â”€
2025-09-20 19:08:00,426 [subspace_lora.py] =>       ğŸ† Variant 'per-class' is best in both final task and average performance.
2025-09-20 19:08:09,133 [subspace_lora.py] => System training on classes 20-40 (imagenet-r)
2025-09-20 19:08:11,410 [subspace_lora.py] => Checkpoint saved to: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993/after_task_2.pth
2025-09-20 19:08:27,153 [subspace_lora.py] => Task 2 finished â€“ total: 18.39 s | train: 2.26 s | drift: 15.74 s
2025-09-20 19:08:29,966 [subspace_lora.py] => Evaluating after task 2...
2025-09-20 19:08:32,913 [subspace_lora.py] => ğŸ“Š Incremental Learning Evaluation Analysis:
2025-09-20 19:08:32,913 [subspace_lora.py] =>    Last Task ID: 2
2025-09-20 19:08:32,913 [subspace_lora.py] =>   â”€â”€ Final Task Accuracy (%) â”€â”€
2025-09-20 19:08:32,913 [subspace_lora.py] =>       per-class            : 71.46%
2025-09-20 19:08:32,913 [subspace_lora.py] =>       per-class_compensate : 71.23%
2025-09-20 19:08:32,913 [subspace_lora.py] =>    â”€â”€ Average Accuracy Across Tasks (%) â”€â”€
2025-09-20 19:08:32,913 [subspace_lora.py] =>       per-class            : 75.13%
2025-09-20 19:08:32,913 [subspace_lora.py] =>       per-class_compensate : 74.44%
2025-09-20 19:08:32,913 [subspace_lora.py] =>    â”€â”€ Summary â”€â”€
2025-09-20 19:08:32,913 [subspace_lora.py] =>       ğŸ† Variant 'per-class' is best in both final task and average performance.
2025-09-20 19:08:40,839 [subspace_lora.py] => System training on classes 40-60 (imagenet-r)
2025-09-20 19:08:43,211 [subspace_lora.py] => Checkpoint saved to: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993/after_task_3.pth
2025-09-20 19:08:58,276 [subspace_lora.py] => Task 3 finished â€“ total: 17.82 s | train: 2.35 s | drift: 15.06 s
2025-09-20 19:09:02,132 [subspace_lora.py] => Evaluating after task 3...
2025-09-20 19:09:06,119 [subspace_lora.py] => ğŸ“Š Incremental Learning Evaluation Analysis:
2025-09-20 19:09:06,119 [subspace_lora.py] =>    Last Task ID: 3
2025-09-20 19:09:06,120 [subspace_lora.py] =>   â”€â”€ Final Task Accuracy (%) â”€â”€
2025-09-20 19:09:06,120 [subspace_lora.py] =>       per-class            : 66.53%
2025-09-20 19:09:06,120 [subspace_lora.py] =>       per-class_compensate : 66.68%
2025-09-20 19:09:06,120 [subspace_lora.py] =>    â”€â”€ Average Accuracy Across Tasks (%) â”€â”€
2025-09-20 19:09:06,120 [subspace_lora.py] =>       per-class            : 72.27%
2025-09-20 19:09:06,120 [subspace_lora.py] =>       per-class_compensate : 71.85%
2025-09-20 19:09:06,120 [subspace_lora.py] =>    â”€â”€ Summary â”€â”€
2025-09-20 19:09:06,120 [subspace_lora.py] =>       ğŸ¥‡ Best in Final Task: 'per-class_compensate' | ğŸ“ˆ Best Average: 'per-class'
2025-09-20 19:09:14,158 [subspace_lora.py] => System training on classes 60-80 (imagenet-r)
2025-09-20 19:09:16,553 [subspace_lora.py] => Checkpoint saved to: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993/after_task_4.pth
2025-09-20 19:09:32,972 [subspace_lora.py] => Task 4 finished â€“ total: 19.25 s | train: 2.38 s | drift: 16.42 s
2025-09-20 19:09:38,452 [subspace_lora.py] => Evaluating after task 4...
2025-09-20 19:09:43,396 [subspace_lora.py] => ğŸ“Š Incremental Learning Evaluation Analysis:
2025-09-20 19:09:43,396 [subspace_lora.py] =>    Last Task ID: 4
2025-09-20 19:09:43,396 [subspace_lora.py] =>   â”€â”€ Final Task Accuracy (%) â”€â”€
2025-09-20 19:09:43,396 [subspace_lora.py] =>       per-class            : 63.93%
2025-09-20 19:09:43,396 [subspace_lora.py] =>       per-class_compensate : 63.89%
2025-09-20 19:09:43,396 [subspace_lora.py] =>    â”€â”€ Average Accuracy Across Tasks (%) â”€â”€
2025-09-20 19:09:43,396 [subspace_lora.py] =>       per-class            : 70.18%
2025-09-20 19:09:43,396 [subspace_lora.py] =>       per-class_compensate : 69.86%
2025-09-20 19:09:43,396 [subspace_lora.py] =>    â”€â”€ Summary â”€â”€
2025-09-20 19:09:43,396 [subspace_lora.py] =>       ğŸ† Variant 'per-class' is best in both final task and average performance.
2025-09-20 19:09:50,991 [subspace_lora.py] => System training on classes 80-100 (imagenet-r)
2025-09-20 19:09:53,410 [subspace_lora.py] => Checkpoint saved to: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993/after_task_5.pth
2025-09-20 19:13:04,518 [trainer.py] => dataset: imagenet-r
2025-09-20 19:13:04,518 [trainer.py] => smart_defaults: False
2025-09-20 19:13:04,518 [trainer.py] => user: authors
2025-09-20 19:13:04,518 [trainer.py] => memory_size: 0
2025-09-20 19:13:04,518 [trainer.py] => memory_per_class: 0
2025-09-20 19:13:04,518 [trainer.py] => fixed_memory: False
2025-09-20 19:13:04,518 [trainer.py] => shuffle: True
2025-09-20 19:13:04,518 [trainer.py] => init_cls: 20
2025-09-20 19:13:04,518 [trainer.py] => increment: 20
2025-09-20 19:13:04,518 [trainer.py] => model_name: sldc
2025-09-20 19:13:04,518 [trainer.py] => vit_type: vit-b-p16
2025-09-20 19:13:04,518 [trainer.py] => weight_decay: 0.0
2025-09-20 19:13:04,518 [trainer.py] => device: [device(type='cuda', index=0)]
2025-09-20 19:13:04,518 [trainer.py] => lora_rank: 4
2025-09-20 19:13:04,518 [trainer.py] => lora_type: sgp_lora
2025-09-20 19:13:04,519 [trainer.py] => weight_temp: 5.0
2025-09-20 19:13:04,519 [trainer.py] => weight_kind: log1p
2025-09-20 19:13:04,519 [trainer.py] => weight_p: 1.0
2025-09-20 19:13:04,519 [trainer.py] => nsp_eps: 0.05
2025-09-20 19:13:04,519 [trainer.py] => nsp_weight: 0.0
2025-09-20 19:13:04,519 [trainer.py] => sce_a: 0.5
2025-09-20 19:13:04,519 [trainer.py] => sce_b: 0.5
2025-09-20 19:13:04,519 [trainer.py] => seed_list: [1993]
2025-09-20 19:13:04,519 [trainer.py] => iterations: 20
2025-09-20 19:13:04,519 [trainer.py] => warmup_steps: 200
2025-09-20 19:13:04,519 [trainer.py] => ca_epochs: 5
2025-09-20 19:13:04,519 [trainer.py] => optimizer: sgd
2025-09-20 19:13:04,519 [trainer.py] => lrate: 0.002
2025-09-20 19:13:04,519 [trainer.py] => batch_size: 24
2025-09-20 19:13:04,519 [trainer.py] => gamma_norm: 0.1
2025-09-20 19:13:04,519 [trainer.py] => gamma_kd: 0.0
2025-09-20 19:13:04,519 [trainer.py] => kd_type: feat
2025-09-20 19:13:04,519 [trainer.py] => compensate: True
2025-09-20 19:13:04,519 [trainer.py] => eval_only: False
2025-09-20 19:13:04,519 [trainer.py] => auxiliary_data_path: /data1/open_datasets/ImageNet-2012/train
2025-09-20 19:13:04,519 [trainer.py] => aux_dataset: imagenet
2025-09-20 19:13:04,519 [trainer.py] => auxiliary_data_size: 1024
2025-09-20 19:13:04,519 [trainer.py] => l2_protection: True
2025-09-20 19:13:04,519 [trainer.py] => l2_protection_lambda: 0.0001
2025-09-20 19:13:04,519 [trainer.py] => seed: 1993
2025-09-20 19:13:04,519 [trainer.py] => run_id: 0
2025-09-20 19:13:04,519 [trainer.py] => log_path: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993
2025-09-20 19:13:04,519 [data_manager.py] => [DataManager] args_for_idata = {'dataset': 'imagenet-r', 'smart_defaults': False, 'user': 'authors', 'memory_size': 0, 'memory_per_class': 0, 'fixed_memory': False, 'shuffle': True, 'init_cls': 20, 'increment': 20, 'model_name': 'sldc', 'vit_type': 'vit-b-p16', 'weight_decay': 0.0, 'device': [device(type='cuda', index=0)], 'lora_rank': 4, 'lora_type': 'sgp_lora', 'weight_temp': 5.0, 'weight_kind': 'log1p', 'weight_p': 1.0, 'nsp_eps': 0.05, 'nsp_weight': 0.0, 'sce_a': 0.5, 'sce_b': 0.5, 'seed_list': [1993], 'iterations': 20, 'warmup_steps': 200, 'ca_epochs': 5, 'optimizer': 'sgd', 'lrate': 0.002, 'batch_size': 24, 'gamma_norm': 0.1, 'gamma_kd': 0.0, 'kd_type': 'feat', 'compensate': True, 'eval_only': False, 'auxiliary_data_path': '/data1/open_datasets/ImageNet-2012/train', 'aux_dataset': 'imagenet', 'auxiliary_data_size': 1024, 'l2_protection': True, 'l2_protection_lambda': 0.0001, 'seed': 1993, 'run_id': 0, 'log_path': 'sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993'}
2025-09-20 19:13:04,591 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2025-09-20 19:13:05,926 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-09-20 19:13:06,536 [_hub.py] => [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-09-20 19:13:23,259 [subspace_lora.py] => Compiled network with torch.compile
2025-09-20 19:13:23,260 [subspace_lora.py] => Optimizer instantiated: lrate=0.002, wd=0.0, optimizer=sgd
2025-09-20 19:13:23,261 [trainer.py] => All params: 86469888
2025-09-20 19:13:23,261 [trainer.py] => Trainable params: 672768
2025-09-20 19:13:23,358 [subspace_lora.py] => System training on classes 0-20 (imagenet-r)
2025-09-20 19:13:26,093 [subspace_lora.py] => Checkpoint saved to: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993/after_task_1.pth
2025-09-20 19:13:36,286 [subspace_lora.py] => Task 1 finished â€“ total: 13.02 s | train: 2.72 s | drift: 10.19 s
2025-09-20 19:13:37,519 [subspace_lora.py] => Evaluating after task 1...
2025-09-20 19:13:39,178 [subspace_lora.py] => ğŸ“Š Incremental Learning Evaluation Analysis:
2025-09-20 19:13:39,178 [subspace_lora.py] =>    Last Task ID: 1
2025-09-20 19:13:39,178 [subspace_lora.py] =>   â”€â”€ Final Task Accuracy (%) â”€â”€
2025-09-20 19:13:39,178 [subspace_lora.py] =>       per-class            : 78.81%
2025-09-20 19:13:39,178 [subspace_lora.py] =>       per-class_compensate : 77.65%
2025-09-20 19:13:39,178 [subspace_lora.py] =>    â”€â”€ Average Accuracy Across Tasks (%) â”€â”€
2025-09-20 19:13:39,178 [subspace_lora.py] =>       per-class            : 78.81%
2025-09-20 19:13:39,178 [subspace_lora.py] =>       per-class_compensate : 77.65%
2025-09-20 19:13:39,178 [subspace_lora.py] =>    â”€â”€ Summary â”€â”€
2025-09-20 19:13:39,179 [subspace_lora.py] =>       ğŸ† Variant 'per-class' is best in both final task and average performance.
2025-09-20 19:13:47,983 [subspace_lora.py] => System training on classes 20-40 (imagenet-r)
2025-09-20 19:14:36,309 [trainer.py] => dataset: imagenet-r
2025-09-20 19:14:36,309 [trainer.py] => smart_defaults: False
2025-09-20 19:14:36,309 [trainer.py] => user: authors
2025-09-20 19:14:36,309 [trainer.py] => memory_size: 0
2025-09-20 19:14:36,310 [trainer.py] => memory_per_class: 0
2025-09-20 19:14:36,310 [trainer.py] => fixed_memory: False
2025-09-20 19:14:36,310 [trainer.py] => shuffle: True
2025-09-20 19:14:36,310 [trainer.py] => init_cls: 20
2025-09-20 19:14:36,310 [trainer.py] => increment: 20
2025-09-20 19:14:36,310 [trainer.py] => model_name: sldc
2025-09-20 19:14:36,310 [trainer.py] => vit_type: vit-b-p16
2025-09-20 19:14:36,310 [trainer.py] => weight_decay: 0.0
2025-09-20 19:14:36,310 [trainer.py] => device: [device(type='cuda', index=0)]
2025-09-20 19:14:36,310 [trainer.py] => lora_rank: 4
2025-09-20 19:14:36,310 [trainer.py] => lora_type: sgp_lora
2025-09-20 19:14:36,310 [trainer.py] => weight_temp: 5.0
2025-09-20 19:14:36,310 [trainer.py] => weight_kind: log1p
2025-09-20 19:14:36,310 [trainer.py] => weight_p: 1.0
2025-09-20 19:14:36,310 [trainer.py] => nsp_eps: 0.05
2025-09-20 19:14:36,310 [trainer.py] => nsp_weight: 0.0
2025-09-20 19:14:36,310 [trainer.py] => sce_a: 0.5
2025-09-20 19:14:36,310 [trainer.py] => sce_b: 0.5
2025-09-20 19:14:36,310 [trainer.py] => seed_list: [1993]
2025-09-20 19:14:36,310 [trainer.py] => iterations: 20
2025-09-20 19:14:36,310 [trainer.py] => warmup_steps: 200
2025-09-20 19:14:36,310 [trainer.py] => ca_epochs: 5
2025-09-20 19:14:36,310 [trainer.py] => optimizer: sgd
2025-09-20 19:14:36,310 [trainer.py] => lrate: 0.002
2025-09-20 19:14:36,310 [trainer.py] => batch_size: 24
2025-09-20 19:14:36,310 [trainer.py] => gamma_norm: 0.1
2025-09-20 19:14:36,310 [trainer.py] => gamma_kd: 0.0
2025-09-20 19:14:36,310 [trainer.py] => kd_type: feat
2025-09-20 19:14:36,310 [trainer.py] => compensate: True
2025-09-20 19:14:36,310 [trainer.py] => eval_only: False
2025-09-20 19:14:36,310 [trainer.py] => auxiliary_data_path: /data1/open_datasets/ImageNet-2012/train
2025-09-20 19:14:36,310 [trainer.py] => aux_dataset: imagenet
2025-09-20 19:14:36,311 [trainer.py] => auxiliary_data_size: 1024
2025-09-20 19:14:36,311 [trainer.py] => l2_protection: True
2025-09-20 19:14:36,311 [trainer.py] => l2_protection_lambda: 0.0001
2025-09-20 19:14:36,311 [trainer.py] => seed: 1993
2025-09-20 19:14:36,311 [trainer.py] => run_id: 0
2025-09-20 19:14:36,311 [trainer.py] => log_path: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993
2025-09-20 19:14:36,311 [data_manager.py] => [DataManager] args_for_idata = {'dataset': 'imagenet-r', 'smart_defaults': False, 'user': 'authors', 'memory_size': 0, 'memory_per_class': 0, 'fixed_memory': False, 'shuffle': True, 'init_cls': 20, 'increment': 20, 'model_name': 'sldc', 'vit_type': 'vit-b-p16', 'weight_decay': 0.0, 'device': [device(type='cuda', index=0)], 'lora_rank': 4, 'lora_type': 'sgp_lora', 'weight_temp': 5.0, 'weight_kind': 'log1p', 'weight_p': 1.0, 'nsp_eps': 0.05, 'nsp_weight': 0.0, 'sce_a': 0.5, 'sce_b': 0.5, 'seed_list': [1993], 'iterations': 20, 'warmup_steps': 200, 'ca_epochs': 5, 'optimizer': 'sgd', 'lrate': 0.002, 'batch_size': 24, 'gamma_norm': 0.1, 'gamma_kd': 0.0, 'kd_type': 'feat', 'compensate': True, 'eval_only': False, 'auxiliary_data_path': '/data1/open_datasets/ImageNet-2012/train', 'aux_dataset': 'imagenet', 'auxiliary_data_size': 1024, 'l2_protection': True, 'l2_protection_lambda': 0.0001, 'seed': 1993, 'run_id': 0, 'log_path': 'sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993'}
2025-09-20 19:14:36,384 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2025-09-20 19:14:37,740 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-09-20 19:14:38,343 [_hub.py] => [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-09-20 19:14:56,904 [subspace_lora.py] => Compiled network with torch.compile
2025-09-20 19:14:56,905 [subspace_lora.py] => Optimizer instantiated: lrate=0.002, wd=0.0, optimizer=sgd
2025-09-20 19:14:56,905 [trainer.py] => All params: 86469888
2025-09-20 19:14:56,906 [trainer.py] => Trainable params: 672768
2025-09-20 19:14:56,988 [subspace_lora.py] => System training on classes 0-20 (imagenet-r)
2025-09-20 19:14:59,631 [subspace_lora.py] => Checkpoint saved to: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993/after_task_1.pth
2025-09-20 19:15:09,721 [subspace_lora.py] => Task 1 finished â€“ total: 12.81 s | train: 2.63 s | drift: 10.09 s
2025-09-20 19:15:11,148 [subspace_lora.py] => Evaluating after task 1...
2025-09-20 19:15:12,798 [subspace_lora.py] => ğŸ“Š Incremental Learning Evaluation Analysis:
2025-09-20 19:15:12,798 [subspace_lora.py] =>    Last Task ID: 1
2025-09-20 19:15:12,799 [subspace_lora.py] =>   â”€â”€ Final Task Accuracy (%) â”€â”€
2025-09-20 19:15:12,799 [subspace_lora.py] =>       per-class            : 78.81%
2025-09-20 19:15:12,799 [subspace_lora.py] =>       per-class_compensate : 77.65%
2025-09-20 19:15:12,799 [subspace_lora.py] =>    â”€â”€ Average Accuracy Across Tasks (%) â”€â”€
2025-09-20 19:15:12,799 [subspace_lora.py] =>       per-class            : 78.81%
2025-09-20 19:15:12,799 [subspace_lora.py] =>       per-class_compensate : 77.65%
2025-09-20 19:15:12,799 [subspace_lora.py] =>    â”€â”€ Summary â”€â”€
2025-09-20 19:15:12,799 [subspace_lora.py] =>       ğŸ† Variant 'per-class' is best in both final task and average performance.
2025-09-20 19:15:21,461 [subspace_lora.py] => System training on classes 20-40 (imagenet-r)
2025-09-20 19:17:42,298 [trainer.py] => dataset: imagenet-r
2025-09-20 19:17:42,298 [trainer.py] => smart_defaults: False
2025-09-20 19:17:42,298 [trainer.py] => user: authors
2025-09-20 19:17:42,299 [trainer.py] => memory_size: 0
2025-09-20 19:17:42,299 [trainer.py] => memory_per_class: 0
2025-09-20 19:17:42,299 [trainer.py] => fixed_memory: False
2025-09-20 19:17:42,299 [trainer.py] => shuffle: True
2025-09-20 19:17:42,299 [trainer.py] => init_cls: 20
2025-09-20 19:17:42,299 [trainer.py] => increment: 20
2025-09-20 19:17:42,299 [trainer.py] => model_name: sldc
2025-09-20 19:17:42,299 [trainer.py] => vit_type: vit-b-p16
2025-09-20 19:17:42,299 [trainer.py] => weight_decay: 0.0
2025-09-20 19:17:42,299 [trainer.py] => device: [device(type='cuda', index=0)]
2025-09-20 19:17:42,299 [trainer.py] => lora_rank: 4
2025-09-20 19:17:42,299 [trainer.py] => lora_type: sgp_lora
2025-09-20 19:17:42,299 [trainer.py] => weight_temp: 5.0
2025-09-20 19:17:42,299 [trainer.py] => weight_kind: log1p
2025-09-20 19:17:42,299 [trainer.py] => weight_p: 1.0
2025-09-20 19:17:42,299 [trainer.py] => nsp_eps: 0.05
2025-09-20 19:17:42,299 [trainer.py] => nsp_weight: 0.0
2025-09-20 19:17:42,299 [trainer.py] => sce_a: 0.5
2025-09-20 19:17:42,299 [trainer.py] => sce_b: 0.5
2025-09-20 19:17:42,299 [trainer.py] => seed_list: [1993]
2025-09-20 19:17:42,299 [trainer.py] => iterations: 20
2025-09-20 19:17:42,299 [trainer.py] => warmup_steps: 200
2025-09-20 19:17:42,299 [trainer.py] => ca_epochs: 5
2025-09-20 19:17:42,299 [trainer.py] => optimizer: sgd
2025-09-20 19:17:42,299 [trainer.py] => lrate: 0.002
2025-09-20 19:17:42,299 [trainer.py] => batch_size: 24
2025-09-20 19:17:42,299 [trainer.py] => gamma_norm: 0.1
2025-09-20 19:17:42,299 [trainer.py] => gamma_kd: 0.0
2025-09-20 19:17:42,299 [trainer.py] => kd_type: feat
2025-09-20 19:17:42,299 [trainer.py] => compensate: True
2025-09-20 19:17:42,299 [trainer.py] => eval_only: False
2025-09-20 19:17:42,299 [trainer.py] => auxiliary_data_path: /data1/open_datasets/ImageNet-2012/train
2025-09-20 19:17:42,299 [trainer.py] => aux_dataset: imagenet
2025-09-20 19:17:42,300 [trainer.py] => auxiliary_data_size: 1024
2025-09-20 19:17:42,300 [trainer.py] => l2_protection: True
2025-09-20 19:17:42,300 [trainer.py] => l2_protection_lambda: 0.0001
2025-09-20 19:17:42,300 [trainer.py] => seed: 1993
2025-09-20 19:17:42,300 [trainer.py] => run_id: 0
2025-09-20 19:17:42,300 [trainer.py] => log_path: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993
2025-09-20 19:17:42,300 [data_manager.py] => [DataManager] args_for_idata = {'dataset': 'imagenet-r', 'smart_defaults': False, 'user': 'authors', 'memory_size': 0, 'memory_per_class': 0, 'fixed_memory': False, 'shuffle': True, 'init_cls': 20, 'increment': 20, 'model_name': 'sldc', 'vit_type': 'vit-b-p16', 'weight_decay': 0.0, 'device': [device(type='cuda', index=0)], 'lora_rank': 4, 'lora_type': 'sgp_lora', 'weight_temp': 5.0, 'weight_kind': 'log1p', 'weight_p': 1.0, 'nsp_eps': 0.05, 'nsp_weight': 0.0, 'sce_a': 0.5, 'sce_b': 0.5, 'seed_list': [1993], 'iterations': 20, 'warmup_steps': 200, 'ca_epochs': 5, 'optimizer': 'sgd', 'lrate': 0.002, 'batch_size': 24, 'gamma_norm': 0.1, 'gamma_kd': 0.0, 'kd_type': 'feat', 'compensate': True, 'eval_only': False, 'auxiliary_data_path': '/data1/open_datasets/ImageNet-2012/train', 'aux_dataset': 'imagenet', 'auxiliary_data_size': 1024, 'l2_protection': True, 'l2_protection_lambda': 0.0001, 'seed': 1993, 'run_id': 0, 'log_path': 'sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993'}
2025-09-20 19:17:42,372 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2025-09-20 19:17:43,732 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-09-20 19:17:44,427 [_hub.py] => [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-09-20 19:18:00,821 [subspace_lora.py] => Compiled network with torch.compile
2025-09-20 19:18:00,821 [subspace_lora.py] => Optimizer instantiated: lrate=0.002, wd=0.0, optimizer=sgd
2025-09-20 19:18:00,822 [trainer.py] => All params: 86469888
2025-09-20 19:18:00,823 [trainer.py] => Trainable params: 672768
2025-09-20 19:18:00,921 [subspace_lora.py] => System training on classes 0-20 (imagenet-r)
2025-09-20 19:18:03,545 [subspace_lora.py] => Checkpoint saved to: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993/after_task_1.pth
2025-09-20 19:18:13,682 [subspace_lora.py] => Task 1 finished â€“ total: 12.86 s | train: 2.61 s | drift: 10.14 s
2025-09-20 19:18:20,050 [subspace_lora.py] => Evaluating after task 1...
2025-09-20 19:18:21,699 [subspace_lora.py] => ğŸ“Š Incremental Learning Evaluation Analysis:
2025-09-20 19:18:21,699 [subspace_lora.py] =>    Last Task ID: 1
2025-09-20 19:18:21,699 [subspace_lora.py] =>   â”€â”€ Final Task Accuracy (%) â”€â”€
2025-09-20 19:18:21,699 [subspace_lora.py] =>       per-class            : 80.99%
2025-09-20 19:18:21,699 [subspace_lora.py] =>       per-class_compensate : 80.84%
2025-09-20 19:18:21,699 [subspace_lora.py] =>    â”€â”€ Average Accuracy Across Tasks (%) â”€â”€
2025-09-20 19:18:21,699 [subspace_lora.py] =>       per-class            : 80.99%
2025-09-20 19:18:21,699 [subspace_lora.py] =>       per-class_compensate : 80.84%
2025-09-20 19:18:21,699 [subspace_lora.py] =>    â”€â”€ Summary â”€â”€
2025-09-20 19:18:21,699 [subspace_lora.py] =>       ğŸ† Variant 'per-class' is best in both final task and average performance.
2025-09-20 19:18:30,418 [subspace_lora.py] => System training on classes 20-40 (imagenet-r)
2025-09-20 19:18:32,694 [subspace_lora.py] => Checkpoint saved to: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993/after_task_2.pth
2025-09-20 19:20:08,333 [trainer.py] => dataset: imagenet-r
2025-09-20 19:20:08,333 [trainer.py] => smart_defaults: False
2025-09-20 19:20:08,333 [trainer.py] => user: authors
2025-09-20 19:20:08,333 [trainer.py] => memory_size: 0
2025-09-20 19:20:08,333 [trainer.py] => memory_per_class: 0
2025-09-20 19:20:08,333 [trainer.py] => fixed_memory: False
2025-09-20 19:20:08,333 [trainer.py] => shuffle: True
2025-09-20 19:20:08,333 [trainer.py] => init_cls: 20
2025-09-20 19:20:08,333 [trainer.py] => increment: 20
2025-09-20 19:20:08,333 [trainer.py] => model_name: sldc
2025-09-20 19:20:08,333 [trainer.py] => vit_type: vit-b-p16
2025-09-20 19:20:08,333 [trainer.py] => weight_decay: 0.0
2025-09-20 19:20:08,333 [trainer.py] => device: [device(type='cuda', index=0)]
2025-09-20 19:20:08,333 [trainer.py] => lora_rank: 4
2025-09-20 19:20:08,333 [trainer.py] => lora_type: sgp_lora
2025-09-20 19:20:08,333 [trainer.py] => weight_temp: 5.0
2025-09-20 19:20:08,333 [trainer.py] => weight_kind: log1p
2025-09-20 19:20:08,333 [trainer.py] => weight_p: 1.0
2025-09-20 19:20:08,333 [trainer.py] => nsp_eps: 0.05
2025-09-20 19:20:08,333 [trainer.py] => nsp_weight: 0.0
2025-09-20 19:20:08,333 [trainer.py] => sce_a: 0.5
2025-09-20 19:20:08,333 [trainer.py] => sce_b: 0.5
2025-09-20 19:20:08,333 [trainer.py] => seed_list: [1993]
2025-09-20 19:20:08,333 [trainer.py] => iterations: 20
2025-09-20 19:20:08,333 [trainer.py] => warmup_steps: 200
2025-09-20 19:20:08,334 [trainer.py] => ca_epochs: 5
2025-09-20 19:20:08,334 [trainer.py] => optimizer: sgd
2025-09-20 19:20:08,334 [trainer.py] => lrate: 0.002
2025-09-20 19:20:08,334 [trainer.py] => batch_size: 24
2025-09-20 19:20:08,334 [trainer.py] => gamma_norm: 0.1
2025-09-20 19:20:08,334 [trainer.py] => gamma_kd: 0.0
2025-09-20 19:20:08,334 [trainer.py] => kd_type: feat
2025-09-20 19:20:08,334 [trainer.py] => compensate: True
2025-09-20 19:20:08,334 [trainer.py] => eval_only: False
2025-09-20 19:20:08,334 [trainer.py] => auxiliary_data_path: /data1/open_datasets/ImageNet-2012/train
2025-09-20 19:20:08,334 [trainer.py] => aux_dataset: imagenet
2025-09-20 19:20:08,334 [trainer.py] => auxiliary_data_size: 1024
2025-09-20 19:20:08,334 [trainer.py] => l2_protection: True
2025-09-20 19:20:08,334 [trainer.py] => l2_protection_lambda: 0.0001
2025-09-20 19:20:08,334 [trainer.py] => seed: 1993
2025-09-20 19:20:08,334 [trainer.py] => run_id: 0
2025-09-20 19:20:08,334 [trainer.py] => log_path: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993
2025-09-20 19:20:08,334 [data_manager.py] => [DataManager] args_for_idata = {'dataset': 'imagenet-r', 'smart_defaults': False, 'user': 'authors', 'memory_size': 0, 'memory_per_class': 0, 'fixed_memory': False, 'shuffle': True, 'init_cls': 20, 'increment': 20, 'model_name': 'sldc', 'vit_type': 'vit-b-p16', 'weight_decay': 0.0, 'device': [device(type='cuda', index=0)], 'lora_rank': 4, 'lora_type': 'sgp_lora', 'weight_temp': 5.0, 'weight_kind': 'log1p', 'weight_p': 1.0, 'nsp_eps': 0.05, 'nsp_weight': 0.0, 'sce_a': 0.5, 'sce_b': 0.5, 'seed_list': [1993], 'iterations': 20, 'warmup_steps': 200, 'ca_epochs': 5, 'optimizer': 'sgd', 'lrate': 0.002, 'batch_size': 24, 'gamma_norm': 0.1, 'gamma_kd': 0.0, 'kd_type': 'feat', 'compensate': True, 'eval_only': False, 'auxiliary_data_path': '/data1/open_datasets/ImageNet-2012/train', 'aux_dataset': 'imagenet', 'auxiliary_data_size': 1024, 'l2_protection': True, 'l2_protection_lambda': 0.0001, 'seed': 1993, 'run_id': 0, 'log_path': 'sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993'}
2025-09-20 19:20:08,406 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2025-09-20 19:20:09,754 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-09-20 19:20:10,350 [_hub.py] => [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-09-20 19:20:25,977 [subspace_lora.py] => Compiled network with torch.compile
2025-09-20 19:20:25,977 [subspace_lora.py] => Optimizer instantiated: lrate=0.002, wd=0.0, optimizer=sgd
2025-09-20 19:20:25,978 [trainer.py] => All params: 86469888
2025-09-20 19:20:25,979 [trainer.py] => Trainable params: 672768
2025-09-20 19:20:26,064 [subspace_lora.py] => System training on classes 0-20 (imagenet-r)
2025-09-20 19:20:28,718 [subspace_lora.py] => Checkpoint saved to: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993/after_task_1.pth
2025-09-20 19:20:38,767 [subspace_lora.py] => Task 1 finished â€“ total: 12.79 s | train: 2.63 s | drift: 10.05 s
2025-09-20 19:20:44,746 [subspace_lora.py] => Evaluating after task 1...
2025-09-20 19:20:46,385 [subspace_lora.py] => ğŸ“Š Incremental Learning Evaluation Analysis:
2025-09-20 19:20:46,385 [subspace_lora.py] =>    Last Task ID: 1
2025-09-20 19:20:46,385 [subspace_lora.py] =>   â”€â”€ Final Task Accuracy (%) â”€â”€
2025-09-20 19:20:46,386 [subspace_lora.py] =>       per-class            : 80.99%
2025-09-20 19:20:46,386 [subspace_lora.py] =>       per-class_compensate : 80.84%
2025-09-20 19:20:46,386 [subspace_lora.py] =>    â”€â”€ Average Accuracy Across Tasks (%) â”€â”€
2025-09-20 19:20:46,386 [subspace_lora.py] =>       per-class            : 80.99%
2025-09-20 19:20:46,386 [subspace_lora.py] =>       per-class_compensate : 80.84%
2025-09-20 19:20:46,386 [subspace_lora.py] =>    â”€â”€ Summary â”€â”€
2025-09-20 19:20:46,386 [subspace_lora.py] =>       ğŸ† Variant 'per-class' is best in both final task and average performance.
2025-09-20 19:20:55,230 [subspace_lora.py] => System training on classes 20-40 (imagenet-r)
2025-09-20 19:20:57,519 [subspace_lora.py] => Checkpoint saved to: sldc_logs_authors/imagenet-r_vit-b-p16/init-20_inc-20_rank-4_lt-sgp_lora_T-5_comp-1_wk-log1p_wp-1_kd-feat_gkd-0_gn-0p1_optim-sgd_lr-0p002_bz-24_iter-20_seed-1993/after_task_2.pth
